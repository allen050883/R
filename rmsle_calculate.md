# R
library(adabag)
library(Metrics)
library(MLmetrics)
library(caret)
library(Rcpp)
library(ggplot2)
library(fastAdaboost)
library(gbmFit1)
library(kernlab)
library(plyr)
library(tree)
library(C50)
library(rpart)
library(arules)
library(randomForest)
library(compiler)
enableJIT(3)
set.seed(998)
data_1<-read.csv(file="train.csv")
test<-read.csv(file="test.csv")
inTraining <- createDataPartition(data_1$Semana, p = 0.01, list = FALSE)
training <- data_1[ inTraining,]
testing  <- data_1[-inTraining,]
#fitControl <- trainControl(method = "repeatedcv",number = 10,repeats = 1)
#set.seed(825)
#gbmFit1 <- train(Demanda_uni_equil~Semana+Agencia_ID+Canal_ID+Ruta_SAK+Cliente_ID+Producto_ID, data = training, method = "rpart1SE", trControl = fitControl, verbose = FALSE)
#gbmFit1
#train.rpart=rpart(Demanda_uni_equil~Semana+Agencia_ID+Canal_ID+Ruta_SAK+Cliente_ID+Producto_ID, data = training)
#summary(train.rpart)
#plot(train.rpart)
#text(train.tree)
#library(compiler)
#enableJIT(3)
#train.rand=randomForest(Demanda_uni_equil~Semana+Agencia_ID+Canal_ID+Ruta_SAK+Cliente_ID+Producto_ID, data = training)
#summary(train.rand)
#print(train.rand)
#importance(train.rand)
#result_1=predict(train.rand, newdata = test)
#result_1
#write.table(result_1,file="result_randomforest_1.csv",sep=" ")
library(compiler)
enableJIT(3)
FOREST_model <- randomForest(Venta_uni_hoy~Semana+Agencia_ID+Canal_ID+Ruta_SAK+Cliente_ID+Producto_ID, data=training, mtry=3, ntree=500, importance=TRUE, do.trace=100)
print(FOREST_model)
#result_1=predict(FOREST_model, newdata = test)
result_1=predict(FOREST_model, newdata = trainraw7)
rmsle = rmsle(trainraw7$Demanda_uni_equil,result_1)
rmsle
